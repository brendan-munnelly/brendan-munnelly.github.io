<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>
      User orders and shopping card | Creating an E-commerce Website with the
      MERN Stack | Brendan Munnelly
    </title>
    <meta
      name="description"
      content="Using the React Reducer to handle user orders and a shopping cart."
    />

    <!-- Stylesheet-->
    <link
      rel="stylesheet"
      href="../assets/css/full-stack-tutorials-brendan-munnelly.css"
    />

    <!-- Font Awesome 6 icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
      integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark-reasonable.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  </head>

  <body id="top">
    <header>
      <div class="wrapper">
        <div class="sidebar">
          <div><p>&nbsp;</p></div>
        </div>

        <div class="content">
          <h1>User orders and shopping card</h1>
          <h2>
            Using the React Reducer to handle user orders and a shopping cart.
          </h2>
        </div>
      </div>
      <!-- /wrapper -->
    </header>

    <main>
      <aside>
        <h3>Express and MongoDB</h3>

        <p>
          <i class="fa-solid fa-house"></i> &nbsp;<a href="index.html">Home</a>
        </p>

        <h3>THIS TUTORIAL</h3>

        <p><a href="#learning-goals">Project Goals</a></p>

        <p><a href="#intro">Introduction</a></p>

        <p><a href="#reducer">Installing the reducer package</a></p>

        <p><a href="#cart-action">Adding the shopping cart actions</a></p>

        <p>
          <a href="#product-card-update">Updating the ProductCard.jsx file</a>
        </p>

        <p><a href="#cart-page">Creating the CartPage.jsx page</a></p>
        <p><a href="#orders-model">Creating the orders.js Model</a></p>

        <p><a href="#orderss-route">Creating the orders.js Route</a></p>

        <p><a href="#index-update">Updating your index.js file</a></p>

        <p><a href="#ecommerce-images">Adding the ecommerce images</a></p>

        <p><a href="#navbar-update">Updating your NavBar.jsx omponent</a></p>

        <p><a href="#app-update">Updating your App.jsx file</a></p>

        <p><a href="#orders-page">Creating an OrderPage.jsx file</a></p>
        <p><a href="#orders-navbar">Adding orders to NavBar.jsx </a></p>

        <p><a href="#orders-app">Updating App.jsx with orders</a></p>
      </aside>

      <article>
        <section id="learning-goals">
          <h2>Project Goals</h2>
          <p>In this ninth stage of your MERN project, you will:</p>

          <ul>
            <li>
              Use the React Reducer to handle user orders and a shopping cart.
            </li>
          </ul>
        </section>

        <section>
          <h2>Introduction</h2>

          <p>
            In React, state management was often accomplished by lifting state
            up to a common parent component, like in the card component.
          </p>

          <p>
            React Reducer is a built-in feature that allows for a more
            structured and centralized approach to managing state within
            components.
          </p>

          <p>
            A reducer is a pure function that receives two arguments: the
            current state and an action object. The state represents the current
            state of the application, while the action describes the type of
            state change to be performed. Inside the reducer, you can use a
            switch statement to determine the appropriate action type and update
            the state accordingly.
          </p>

          <p>
            Actions are plain JavaScript objects that describe an intention to
            change the state. They typically consist of a type property, which
            indicates the action type, and optionally, a payload property that
            carries additional data. Action types are typically defined as
            constants to avoid typographical errors.
          </p>

          <p>
            React Reducer is typically used in conjunction with the useReducer
            hook, another built-in feature of React. The useReducer hook takes a
            reducer function and an initial state as arguments and returns the
            current state and a dispatch function. The dispatch function is used
            to send actions to the reducer, triggering state updates.
          </p>
        </section>

        <section>
          <h2 id="install-reducer">Installing the reducer package</h2>
          <p>
            Your first step is to install the package in your
            <b>/frontend</b> folder:
          </p>

          <pre class="no-syn">npm i react-redux @reduxjs/toolkit</pre>
        </section>

        <section id="cart-actions">
          <h2>Adding the shopping cart actions</h2>

          <p>Follow these steps:</p>
          <ol>
            <li>
              In your <b>frontend/src/</b> sub-folder, create a new folder named
              <b>/store</b>
            </li>
            <li>
              In this <b>frontend/src/store</b> sub-folder, create a new folder
              named <b>/cart</b>.
            </li>
            <li>
              In the <b>/cart</b> sub-folder, create a new file named
              <b>actionTypes.jsx</b> and paste the code below into it:
              <pre><button class="copy-code" id="btn-1">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-1" class="hljs language-javascript">
export const ADD_TO_CART = "ADD_TO_CART";
export const REMOVE_ITEM = "REMOVE_ITEM";
export const EMPTY_CART = "EMPTY_CART";</code></pre>
            </li>
            <li>
              In the same <b>/cart</b> sub-folder, create a new file named
              <b>cartActions.jsx</b> and paste the code below into it:
              <pre><button class="copy-code" id="btn-2">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-2" class="hljs language-javascript">
import * as actionTypes from "./actionTypes.jsx";

//receives the object
export const addToCart = (item) =&gt; {
  return {
    type: actionTypes.ADD_TO_CART,
    item: item,
  };
};

//receives the object id 
export const removeFromCart = (id) =&gt; {
  return {
    type: actionTypes.REMOVE_ITEM,
    id: id,
  };
};

export const emptyCart = () =&gt; {
  return {
    type: actionTypes.EMPTY_CART,
  };
};</code></pre>
            </li>

            <li>
              Finally, create a third file named <b>cartReducer.jsx</b> and
              paste this code into it:
              <pre><button class="copy-code" id="btn-3">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-3" class="hljs language-javascript">
import { ADD_TO_CART, REMOVE_ITEM, EMPTY_CART } from "./actionTypes.jsx";

const initState = {
  addedItems: [],
  total: 0,
};
const cartReducer = (state = initState, action) =&gt; {

  if (action.type === ADD_TO_CART) {
    console.log("acion", action);
    let addedItem = action.item.product;
    let itemAmount = action.item.amount;
    
    //check if the action id exists in the addedItems
    let existed_item = state.addedItems.find(
      (item) =&gt; addedItem._id === item._id
    );
    
    if (existed_item) {
      let updatedItem = { ...existed_item };
      updatedItem.quantity =
        parseInt(updatedItem.quantity) + parseInt(itemAmount);

      // Create a new array for the modified addedItems
      let updatedAddedItems = state.addedItems.map((item) =&gt;
        item._id === existed_item._id ? updatedItem : item
      );
      
      return {
        ...state,
        addedItems: updatedAddedItems,
        total: state.total + addedItem.price * itemAmount,
      };
    } else {
      addedItem.quantity = parseInt(itemAmount);
      
      //calculating the total
      let newTotal = state.total + addedItem.price * itemAmount;
      
      return {
        ...state,
        addedItems: [...state.addedItems, addedItem],
        total: newTotal,
      };
    }
  } else if (action.type === REMOVE_ITEM) {
    
    let existed_item = state.addedItems.find((item) =&gt; action.id === item._id);
    if (existed_item.quantity &gt; 1) {
      let updatedItem = { ...existed_item };
      updatedItem.quantity -= 1;

      // Create a new array for the modified addedItems
      let updatedAddedItems = state.addedItems.map((item) =&gt;
        item._id === existed_item._id ? updatedItem : item
      );
      
      return {
        ...state,
        addedItems: updatedAddedItems,
        total: state.total - existed_item.price,
      };
    } else {
      let existed_item = state.addedItems.find(
        (item) =&gt; action.id === item._id
      );
      let new_items = state.addedItems.filter((item) =&gt; action.id !== item._id);

      //calculating the total
      let newTotal = state.total - existed_item.price * existed_item.quantity;

      return {
        ...state,
        addedItems: new_items,
        total: newTotal,
      };
    }
  } else if (action.type === EMPTY_CART) {
    return {
      ...state,
      addedItems: [],
      total: 0,
    };
  }
    return state;
  }

export default cartReducer;</code></pre>
            </li>
          </ol>
        </section>

        <section id="update-product-card">
          <h2>Updating the <code>ProductCard.jsx</code> file</h2>

          <p>
            In your <b>frontend/src/components/</b> sub-folder, modify the
            <b>ProductCard.jsx</b> file as follows:
          </p>

          <ol>
            <li>
              Add these two new import statements:
              <img
                src="assets/img/project-reducer/product-card-import.png"
                alt="screenshot"
              />
            </li>
            <li>
              Assign the <b>dispatch</b> function to a variable within the
              <b>productCard</b> function:
              <img
                src="assets/img/project-reducer/dispatch.png"
                alt="screenshot"
              />
            </li>
            <li>
              Next, within the <b>productCard</b> function, add the new function
              below. This is triggered when a user wants to add a product to the
              cart. It retrieves the entered quantity, creates an object with
              the product details and quantity, and dispatches an action to
              update the cart state in the Redux store.
              <pre><button class="copy-code" id="btn-4">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-4" class="hljs language-javascript">
const handleAddToCart = (product) =&gt; {
    console.log(amountInputRef.current.value);
    const product_item = {
      product: product,
      amount: amountInputRef.current.value,
  };
    dispatch(addToCart(product_item));
};</code></pre>
            </li>
            <li>
              Finally, update the UI component and use the function with the
              button.
              <pre><button class="copy-code" id="btn-5">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-5" class="hljs language-javascript">
  return (
    &lt;&gt;
      &lt;Card
        sx={{
          width: 345,
          height: 550,
          display: "flex",
          justifyContent: "space-between",
          flexDirection: "column",
        }}
      &gt;
        &lt;CardHeader title={product.title} /&gt;
        &lt;CardMedia
          component="img"
          height="194"
          image={product.images}
          alt="Product image"
        /&gt;
        &lt;CardContent&gt;
          &lt;Stack direction="column" spacing={1}&gt;
            &lt;Typography variant="body2" color="text.secondary"&gt;
              {product.description}
            &lt;/Typography&gt;
            &lt;Stack direction="row" spacing={1}&gt;
              &lt;Rating
                name="half-rating-read"
                defaultValue={product.rating}
                precision={0.5}
                readOnly
              /&gt;
              &lt;Typography variant="body1" color="text.primary"&gt;
                {product.rating}
              &lt;/Typography&gt;
            &lt;/Stack&gt;
            &lt;Stack direction="column"&gt;
              &lt;Typography variant="body1" color="text.primary"&gt;
                {product.price} $
              &lt;/Typography&gt;
              &lt;Typography variant="body1" color="text.primary"&gt;
                Price discount: {product.discountPercentage}%
              &lt;/Typography&gt;
            &lt;/Stack&gt;
          &lt;/Stack&gt;
        &lt;/CardContent&gt;

        &lt;CardActions&gt;
          {token && isAdmin ? (
            &lt;Stack direction="row" gap={2}&gt;
              &lt;Button
                color="primary"
                variant="contained"
                onClick={() =&gt; handleUpdate(product._id)}
              &gt;
                Update
              &lt;/Button&gt;
              &lt;Button
                color="error"
                variant="contained"
                onClick={() =&gt; handleDelete(product._id)}
              &gt;
                Delete
              &lt;/Button&gt;
            &lt;/Stack&gt;
          ) : (
            &lt;&gt;
              &lt;Stack direction="row" spacing={2}&gt;
                &lt;Button
                  variant="contained"
                  color="primary"
                  endIcon={&lt;AddShoppingCartIcon /&gt;}
                  onClick={() =&gt; handleAddToCart(product)}
                &gt;
                  + Add
                &lt;/Button&gt;
                &lt;TextField
                  inputRef={amountInputRef}
                  sx={{ width: 70 }}
                  label="Amount"
                  id={"amount_" + props.id}
                  type="number"
                  min={1}
                  max={5}
                  step={1}
                  defaultValue={1}
                /&gt;
              &lt;/Stack&gt;
            &lt;/&gt;
          )}
        &lt;/CardActions&gt;
      &lt;/Card&gt;
    &lt;/&gt;
  );
};

export default ProductCard;</code></pre>
            </li>
          </ol>
        </section>

        <section id="cart-page">
          <h2>Creating the <code>CartPage.jsx</code> page</h2>

          <p>
            After creating the cart reducer, you next need to create the
            CartPage where you can display the cart data.
          </p>

          <p>
            In your <b>frontend/src/pages</b> sub-folder, create a
            <b>CartPage.jsx</b> file to display your cart data. See below:
          </p>

          <pre><button class="copy-code" id="btn-6">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-6" class="hljs language-javascript">
import React, { useEffect, useState } from "react";
import { useSelector } from "react-redux";
import { useNavigate } from "react-router-dom";
import { useContext } from "react";
import { AuthContext } from "../context/authContext";
import {
  Grid,
  Button,
  Paper,
  TableCell,
  TableContainer,
  TableRow,
  TableHead,
  TableBody,
  Table,
  IconButton,
  Typography,
  Stack,
  Card,
  TextField,
} from "@mui/material";
import AddIcon from "@mui/icons-material/Add";
import RemoveIcon from "@mui/icons-material/Remove";
import Avatar from "@mui/material/Avatar";
import NavBar from "../components/NavBar";
import InputAdornment from "@mui/material/InputAdornment";
import AccountCircle from "@mui/icons-material/AccountCircle";
import HomeIcon from "@mui/icons-material/Home";
import FlagIcon from "@mui/icons-material/Flag";
import LocationCityIcon from "@mui/icons-material/LocationCity";
import MarkunreadMailbox from "@mui/icons-material/MarkunreadMailbox";
import LocalMallIcon from "@mui/icons-material/LocalMall";
import emptyCartImg from "../img/emptycart.png";

import Dialog from "@mui/material/Dialog";
import DialogActions from "@mui/material/DialogActions";
import DialogContent from "@mui/material/DialogContent";
import DialogTitle from "@mui/material/DialogTitle";

import {
  addToCart,
  removeFromCart,
  emptyCart,
} from "../store/cart/cartActions";
import { useDispatch } from "react-redux";
import axios from "axios";

import LoginForm from "../components/LoginForm";
import RegisterForm from "../components/RegisterForm";

const baseURL = import.meta.env.VITE_BASE_URL;
axios.defaults.baseURL = baseURL;

const CartPage = () =&gt; {
  const navigate = useNavigate();
  const dispatch = useDispatch();
  const authContext = useContext(AuthContext);
  const addedItems = useSelector((state) =&gt; state.cartStore.addedItems);
  const total = useSelector((state) =&gt; state.cartStore.total);
  const [totalAmount, setTotalAmount] = useState(0);
  const [open, setOpen] = React.useState(false);
  const [accountDialog, setAccountDialog] = React.useState(false);
  const [showLogin, setShowLogin] = React.useState(false);
  const [confirmShow, setConfirmShow] = React.useState(false);
  const [checkoutForm, setCheckoutForm] = useState({
    firstName: "",
    lastName: "",
    address: "",
    city: "",
    country: "",
    zipCode: "",
  });

  useEffect(() =&gt; {
    if (total !== undefined) {
      setTotalAmount(`$${total.toFixed(2)}`);
    }
  }, [total, addedItems, totalAmount]);

  const goBack = () =&gt; {
    navigate("/");
  };

  const cartItemRemoveHandler = (id) =&gt; {
    dispatch(removeFromCart(id));
  };

  const cartItemAddHandler = (item) =&gt; {
    const product_item = {
      product: item,
      amount: 1,
    };
    dispatch(addToCart(product_item));
  };

  const handleCheckout = async () =&gt; {
    if (!authContext.token) {
      setOpen(true);
    } else {
      setConfirmShow(true);
    }
  };

  const handleFormInput = (e) =&gt; {
    const { name, value } = e.target;
    setCheckoutForm({ ...checkoutForm, [name]: value });
  };

  const handleGoToLogin = () =&gt; {
    setShowLogin(true);
    setAccountDialog(true);
    setOpen(false);
  };

  const handleCreateAccount = () =&gt; {
    setShowLogin(false);
    setAccountDialog(true);
    setOpen(false);
  };

  const handleCloseAccountDialog = async () =&gt; {
    setAccountDialog(false);
    setConfirmShow(true);
  };

  const handleCancel = () =&gt; {
    setConfirmShow(false);
  };

  const handleConfirm = async () =&gt; {
    const order = {
      userID: localStorage.getItem("userId"),
      firstName: checkoutForm.firstName,
      lastName: checkoutForm.lastName,
      address: checkoutForm.address,
      city: checkoutForm.city,
      country: checkoutForm.country,
      zipCode: checkoutForm.zipCode,
      totalAmount: totalAmount,
      items: addedItems,
      createdDate: new Date(),
    };
    try {
      const response = await axios.post(`${baseURL}/order/create`, {
        data: order,
      });

      if (response.data === "Order saved to the database!") {
        dispatch(emptyCart());
        setConfirmShow(false);
        navigate("/");
      }
    } catch (e) {
      console.log(e);
    }
    console.log(order);
  };
};

export default CartPage;
</code></pre>
        </section>

        <section>
          <h2>Creating the <code>orders.js</code> Model</h2>

          <p>
            Now itâ€™s time to work on the backend layer of your app. Begin by
            creating an <b>order.js</b> file in your
            <b>backend/Models</b> sub-folder. Paste the code below into this
            file:
          </p>

          <pre><button class="copy-code" id="btn-7">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-7" class="hljs language-javascript">
import mongoose from "mongoose";

const orderSchema = new mongoose.Schema({
  userID: { type: String, required: true },
  firstName: { type: String, required: true },
  lastName: { type: String, required: true },
  address: { type: String, required: true },
  city: { type: String, required: true },
  country: { type: String, required: true },
  zipCode: { type: String, required: true },
  totalAmount: { type: String, required: true },
  items: { type: String, required: true },
  createdDate: { type: Date, required: true },
});

const Order = mongoose.model("Order", orderSchema);

export default Order;</code></pre>
        </section>

        <section>
          <h2>Creating the <code>orders.js</code> Route</h2>

          <p>
            In your
            <b>backend/Routes</b> sub-folder, create an <b>order.js</b> file and
            paste the code below into this file:
          </p>

          <pre><button class="copy-code" id="btn-8">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-8" class="hljs language-javascript">
import express from "express";
import mongoose from "mongoose";
import Order from "../Models/products.js";
const router = express.Router();

//Post new order
//Create API
router.post("/create", async (req, res) =&gt; {
  console.log(req.body);
  const newOrder = new Order({
    userID: req.body.data.userID,
    firstName: req.body.data.firstName,
    lastName: req.body.data.lastName,
    address: req.body.data.address,
    city: req.body.data.city,
    country: req.body.data.country,
    zipCode: req.body.data.zipCode,
    totalAmount: req.body.data.totalAmount,
    items: JSON.stringify(req.body.data.items),
    createdDate: req.body.data.createdDate,
  });

  await Order.create(newOrder);
  res.send("Order saved to the database!");
});

router.get("/:userId", async (req, res) =&gt; {
  const userID = req.params.userId;
  const orderList = await Order.find({ userID: userID });
  res.send(orderList);
});

export default router;</code></pre>
        </section>

        <section>
          <h2>Updating your <code>index.js</code> file</h2>

          <p>
            Import the <b>order.js</b> Route into your <b>index.js</b> file and
            add it to your Middleware stack as follows:
          </p>

          <img
            src="assets/img/project-reducer/import-orders.png"
            alt="screenshot"
            style="max-width: 700px"
          />

          <img
            src="assets/img/project-reducer/orders-middleware.png"
            alt="screenshot"
            style="max-width: 670px"
          />
        </section>

        <section>
          <h2>Adding ecommerce images</h2>

          <p>Follow the steps below:</p>

          <ol>
            <li>
              Download the following three images:<br />
              <a href="assets/downloads/project/emptycart.png">emptycart.png</a
              ><br />
              <a href="assets/downloads/project/logo_2.png">logo_2.png</a><br />
              <a href="assets/downloads/project/not_found.png">not_found.png</a>
            </li>
            <li>
              In your <b>frontend/src</b> folder, create a new sub-folder named
              <b>img</b>.
            </li>
            <li>Copy the above three images into this new sub-folder.</li>
          </ol>
        </section>

        <section>
          <h2 id="navbar">Updating your <code>NavBar.jsx</code> component</h2>
          <p>
            Before you can test your orders feature, update your
            <b>frontend/src/components/NavBar.jsx</b> component AS follows:
          </p>

          <ol>
            <li>
              Add these new import statements:

              <pre><button class="copy-code" id="btn-9">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-9" class="hljs language-javascript">
import ShoppingCartIcon from "@mui/icons-material/ShoppingCart";
import Badge from "@mui/material/Badge";
import { IconButton } from "@mui/material";
import { useSelector } from "react-redux";
import logo from "../img/logo_2.png";
import ButtonBase from "@mui/material/ButtonBase";</code></pre>
            </li>

            <li>
              Within the <b>NavBar</b> function, add this new function:
              <pre><button class="copy-code" id="btn-10">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-10" class="hljs language-javascript">  
const goToOrders = () =&gt; {
    navigate("/cart");
};</code></pre>
            </li>

            <li>
              Lastly, update the <b>AppBar</b> component as follows:
              <pre><button class="copy-code" id="btn-11">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-11" class="hljs language-javascript">
&lt;AppBar position="static" sx={{ background: "#38B6FF" }}&gt;
    &lt;Toolbar&gt;
            &lt;ButtonBase onClick={goToHome}&gt;
              &lt;Box
                component="img"
                sx={{ width: "8rem", height: "5rem" }}
                src={logo}
              /&gt;
            &lt;/ButtonBase&gt;
            &lt;Typography variant="h6" component="div" sx={{ flexGrow: 1 }} /&gt;

            &lt;IconButton onClick={goToOrders}&gt;
              &lt;Badge badgeContent={items.length} color="secondary"&gt;
                &lt;ShoppingCartIcon /&gt;
              &lt;/Badge&gt;
            &lt;/IconButton&gt;
            {isAdmin && (
              &lt;Button color="inherit" onClick={goToAddProduct}&gt;
                Add product
              &lt;/Button&gt;
            )}
            {!token ? (
              &lt;Button color="inherit" onClick={goToLogin}&gt;
                Login
              &lt;/Button&gt;
            ) : (
              &lt;Button color="inherit" onClick={logOut}&gt;
                LogOut
              &lt;/Button&gt;
            )}
    &lt;/Toolbar&gt;
&lt;/AppBar&gt;
</code></pre>
            </li>
          </ol>
        </section>

        <section>
          <h2 id="app-update">Updating your <code>App.jsx </code> file</h2>

          <p>
            Open your <b>frontend/app.jsx</b> file and add this new import
            statement:
          </p>

          <pre><button class="copy-code" id="btn-12">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-12" class="hljs language-javascript">
import CartPage from "./pages/CartPage";
          </code></pre>

          <p>Next, add this route:</p>

          <pre><button class="copy-code" id="btn-13">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-13" class="hljs language-javascript">
&lt;Route path="/cart" element={&lt;CartPage /&gt;} /&gt;</code></pre>
        </section>

        <section>
          <h2>Creating an <code>OrderPage.jsx</code> file</h2>
          <p>
            In your <b>frontend/src/pages</b>, create a new file named
            <b>OrdersPage.jsx</b> and add these import statements to it:
          </p>
          <pre><button class="copy-code" id="btn-14">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-14" class="hljs language-javascript">
import React, { useEffect, useState } from "react";            
import NavBar from "../components/NavBar";
import axios from "axios";
import {
  Typography,
  Grid,
  Stack,
  Divider,
  Chip,
  Paper,
  Button,
} from "@mui/material";
import Card from "@mui/material/Card";
import FilterListIcon from "@mui/icons-material/FilterList";
import ExpandLessIcon from "@mui/icons-material/ExpandLess";
import ExpandMoreIcon from "@mui/icons-material/ExpandMore";
import CardContent from "@mui/material/CardContent";
import Table from "@mui/material/Table";
import TableBody from "@mui/material/TableBody";
import TableCell from "@mui/material/TableCell";
import TableContainer from "@mui/material/TableContainer";
import TableHead from "@mui/material/TableHead";
import TableRow from "@mui/material/TableRow";
import Tooltip from "@mui/material/Tooltip";

const baseURL = import.meta.env.VITE_BASE_URL;
axios.defaults.baseURL = baseURL;</code></pre>

          <p>Next, add the <b>OrdersPage</b> component and JSX:</p>

          <pre><button class="copy-code" id="btn-15">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-15" class="hljs language-javascript">
  const OrdersPage = () =&gt; {
  const [orders, setOrders] = useState([]);

  useEffect(() =&gt; {
    getOrders();
  }, []);

  const getOrders = async () =&gt; {
    const userId = localStorage.getItem("userId");
    try {
      const response = await axios.get(`${baseURL}/order/${userId}`);

      setOrders(response.data);
      console.log(response.data);
    } catch (e) {
      console.log(e);
    }
  };

  const sortByDateASC = () =&gt; {
    let arrayForSort = [...orders];
    //ascending
    const ascArray = arrayForSort.sort((a, b) =&gt; {
      const date1 = new Date(a.createdDate);
      const date2 = new Date(b.createdDate);
      return date1 - date2;
    });
    setOrders(ascArray);
  };

  const sortByDateDESC = () =&gt; {
    let arrayForSort = [...orders];
    //descending
    const ascArray = arrayForSort.sort((a, b) =&gt; {
      const date1 = new Date(a.createdDate);
      const date2 = new Date(b.createdDate);
      return date2 - date1;
    });
    setOrders(ascArray);
  };

  return (
    &lt;&gt;
      &lt;NavBar /&gt;
      &lt;Grid
        container
        alignContent="center"
        alignItems="center"
        justifyContent="space-around"
        sx={{ paddingTop: 2 }}
      &gt;
        &lt;Typography variant="h3"&gt;Order history&lt;/Typography&gt;
        &lt;Stack direction="row" gap={2}&gt;
          &lt;Tooltip title="Ascending"&gt;
            &lt;Button
              variant="contained"
              onClick={sortByDateASC}
              startIcon={&lt;FilterListIcon /&gt;}
              endIcon={&lt;ExpandLessIcon /&gt;}
            &gt;
              Date
            &lt;/Button&gt;
          &lt;/Tooltip&gt;
          &lt;Tooltip title="Descending"&gt;
            &lt;Button
              variant="contained"
              onClick={sortByDateDESC}
              startIcon={&lt;FilterListIcon /&gt;}
              endIcon={&lt;ExpandMoreIcon /&gt;}
            &gt;
              Date
            &lt;/Button&gt;
          &lt;/Tooltip&gt;
        &lt;/Stack&gt;
      &lt;/Grid&gt;
      &lt;Grid
        container
        direction="row"
        justifyContent="center"
        alignContent="center"
        alignItems="center"
        gap={2}
        sx={{ paddingTop: 5 }}
      &gt;
        {orders !== undefined &&
          orders.map((Orderitem) =&gt; (
            &lt;Grid item key={Orderitem._id}&gt;
              &lt;Card key={Orderitem._id} sx={{ height: 400 }}&gt;
                &lt;CardContent&gt;
                  &lt;Stack direction="row" justifyContent="space-between"&gt;
                    &lt;div&gt;
                      &lt;Typography
                        sx={{ fontSize: 14 }}
                        color="text.secondary"
                        gutterBottom
                      &gt;
                        Order number:
                      &lt;/Typography&gt;
                      &lt;Typography sx={{ fontSize: 14 }} color="text.primary"&gt;
                        {Orderitem._id}
                      &lt;/Typography&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                      &lt;Typography sx={{ fontSize: 14 }} color="text.primary"&gt;
                        {Orderitem.createdDate}
                      &lt;/Typography&gt;
                    &lt;/div&gt;
                  &lt;/Stack&gt;
                  &lt;Chip label="Processing..." /&gt;
                  &lt;Grid
                    container
                    direction="row"
                    justifyContent="center"
                    alignContent="center"
                    alignItems="center"
                    gap={2}
                    paddingTop={2}
                  &gt;
                    &lt;Grid item&gt;
                      &lt;TableContainer
                        component={Paper}
                        sx={{
                          overflow: "scroll",
                          overflowX: "hidden",
                          maxHeight: 300,
                        }}
                      &gt;
                        &lt;Table sx={{ width: 300 }} aria-label="simple table"&gt;
                          &lt;TableHead&gt;
                            &lt;TableRow&gt;
                              &lt;TableCell&gt;Product&lt;/TableCell&gt;
                              &lt;TableCell&gt;Price&lt;/TableCell&gt;
                              &lt;TableCell&gt;Quantity&lt;/TableCell&gt;
                              &lt;TableCell&gt;Total&lt;/TableCell&gt;
                            &lt;/TableRow&gt;
                          &lt;/TableHead&gt;
                          &lt;TableBody&gt;
                            {JSON.parse(Orderitem.items).map((item) =&gt; (
                              &lt;TableRow
                                key={item._id}
                                sx={{
                                  "&:last-child td, &:last-child th": {
                                    border: 0,
                                  },
                                }}
                              &gt;
                                &lt;TableCell component="th" scope="row"&gt;
                                  {item.title}
                                &lt;/TableCell&gt;
                                &lt;TableCell&gt;${item.price}&lt;/TableCell&gt;
                                &lt;TableCell&gt;{item.quantity}&lt;/TableCell&gt;
                                &lt;TableCell&gt;{Orderitem.totalAmount}&lt;/TableCell&gt;
                              &lt;/TableRow&gt;
                            ))}
                          &lt;/TableBody&gt;
                        &lt;/Table&gt;
                      &lt;/TableContainer&gt;
                    &lt;/Grid&gt;

                    &lt;Divider
                      orientation="vertical"
                      flexItem
                      sx={{ borderRightWidth: 5 }}
                    /&gt;
                    &lt;br /&gt;
                    &lt;Grid item&gt;
                      &lt;Stack direction="column" gap={1}&gt;
                        &lt;Typography variant="h6"&gt;Order details:&lt;/Typography&gt;
                        &lt;Divider /&gt;
                        &lt;Typography&gt;
                          {Orderitem.firstName} {Orderitem.lastName}
                        &lt;/Typography&gt;
                        &lt;Typography variant="h6"&gt;Shipping:&lt;/Typography&gt;
                        &lt;Divider /&gt;
                        &lt;Typography&gt;{Orderitem.address}&lt;/Typography&gt;
                        &lt;Typography&gt;{Orderitem.zipCode}&lt;/Typography&gt;
                        &lt;Typography&gt;{Orderitem.country}&lt;/Typography&gt;
                      &lt;/Stack&gt;
                    &lt;/Grid&gt;
                  &lt;/Grid&gt;
                &lt;/CardContent&gt;
              &lt;/Card&gt;
            &lt;/Grid&gt;
          ))}
      &lt;/Grid&gt;
    &lt;/&gt;
  );
};

export default OrdersPage;</code></pre>
        </section>

        <section>
          <h2>Adding orders to <code>NavBar.jsx</code></h2>

          <p>Modify the <b>frontend/src/components</b> file as follows:</p>

          <ol>
            <li>
              Add this import statement:

              <img
                src="assets/img/project-reducer/import-auth.png"
                alt="screenshot"
                style="max-width: 640px"
              />
            </li>
            <li>
              Add this new line to the <b>NavBar</b> component:

              <img
                src="assets/img/project-reducer/update-navbar-component.png"
                alt="screenshot"
                style="max-width: 680px"
              />
            </li>
            <li>
              Update the current <b>logOut</b> function with this code:
              <pre><button class="copy-code" id="btn-16">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-16" class="hljs language-javascript">
  const logOut = () =&gt; {
    localStorage.clear();
    setIsAdmin();
    setToken();
    authContext.logout();
    navigate("/");
  };</code></pre>
            </li>
            <li></li>
            <li>
              Update the current <b>goToOrders</b> function with this code:
              <pre><button class="copy-code" id="btn-17">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-17" class="hljs language-javascript">
const goToOrders = () =&gt; {
    navigate("/orders");
};</code></pre>
            </li>
            <li>
              In the JSX section, updaste the button that handles the
              <b>goToOrders</b> function as follows:
              <pre><button class="copy-code" id="btn-18">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-18" class="hljs language-javascript">
{token && (
    &lt;Button color="inherit" onClick={goToOrders}&gt;
       Orders
    &lt;/Button&gt;
 )}
 &lt;IconButton onClick={goToCart}&gt;</code></pre>
            </li>
          </ol>
        </section>

        <section>
          <h2>Updating <code>App.jsx</code> with orders</h2>

          <p>Paste the following into your <b>App.jsx</b> file.</p>

          <pre><button class="copy-code" id="btn-19">Copy Code <i class="fa-brands fa-square-js"></i></button><code id="strCode-19" class="hljs language-javascript">
import "./App.css";
import { Route, Routes } from "react-router-dom";
import RequiredAuth from "./util/authRoutes";

import HomePage from "./pages/HomePage";
import AddProductPage from "./pages/AddProductPage";
import UpdateProductPage from "./pages/UpdateProductPage";
import AuthPage from "./pages/AuthPage";

import CartPage from "./pages/CartPage";
import cartReducer from "./store/cart/cartReducer";
import { Provider } from "react-redux";
import { configureStore } from "@reduxjs/toolkit";

import { AuthContext } from "./context/authContext";
import { useState } from "react";
import AdminPage from "./pages/AdminPage";
import OrdersPage from "./pages/OrdersPage";

const store = configureStore({
  reducer: {
    cartStore: cartReducer,
  },
});

function App() {
  const [userLoggedData, setUserLoggedData] = useState({
    token: null,
    userId: null,
    isAdmin: false,
  });

  const login = (token, userId, isAdmin) =&gt; {
    //console.log("app token", token);
    localStorage.setItem("token", token);
    localStorage.setItem("userId", userId);
    setUserLoggedData({ token: token, userId: userId, isAdmin: isAdmin });
  };

  const logout = () =&gt; {
    setUserLoggedData({ token: null, userId: null, isAdmin: false });
    localStorage.removeItem("token");
    localStorage.removeItem("userId");
  };

  return (
    &lt;Provider store={store}&gt;
      &lt;AuthContext.Provider
        value={{
          token: userLoggedData.token,
          userId: userLoggedData.userId,
          isAdmin: userLoggedData.isAdmin,
          login: login,
          logout: logout,
        }}
      &gt;
        &lt;Routes&gt;
          &lt;Route path="/" element={&lt;HomePage /&gt;} /&gt;
          &lt;Route path="/login" element={&lt;AuthPage /&gt;} /&gt;
          &lt;Route path="/cart" element={&lt;CartPage /&gt;} /&gt;
          {/* protected views*/}
          &lt;Route
            path="/addProduct"
            element={
              &lt;RequiredAuth&gt;
                &lt;AddProductPage /&gt;
              &lt;/RequiredAuth&gt;
            }
          /&gt;
          &lt;Route
            path="/update/:id"
            element={
              &lt;RequiredAuth&gt;
                &lt;UpdateProductPage /&gt;
              &lt;/RequiredAuth&gt;
            }
          /&gt;
          &lt;Route
            path="/admin"
            element={
              &lt;RequiredAuth&gt;
                &lt;AdminPage /&gt;
              &lt;/RequiredAuth&gt;
            }
          /&gt;
          &lt;Route
            path="/orders"
            element={
              &lt;RequiredAuth&gt;
                &lt;OrdersPage /&gt;
              &lt;/RequiredAuth&gt;
            }
          /&gt;
        &lt;/Routes&gt;
      &lt;/AuthContext.Provider&gt;
    &lt;/Provider&gt;
  );
}

export default App;</code></pre>

          <p>
            Now, you can test the application by placing some orders and
            visiting the orders page to verify them.
          </p>
        </section>
      </article>
    </main>

    <footer></footer>
    <script>
      hljs.highlightAll();
    </script>

    <script src="../assets/js/utils.js"></script>
  </body>
</html>
